# BigData-Final-Project
Реализация итогового проекта по предмету BigData за 3 курс, 1 семестр.

Задание реализовано с помощью SCD2 слоя
## Задание
Главная цель итогового проекта - продемонстрировать полученные знания и сформировать ETL - процесс (загрузку) данных на основе подготовленных данных и формирование отчета мошеннеческих операций. Процесс должен имитировать загрузку данных в хранилище за 3 дня (ежедневно).

**Выгрузка данных.**

Ежедневно некие информационные системы выгружают следующие файлы:
- Список транзакций за текущий день. Формат – TXT.
- Список терминалов полным срезом. Формат – XLSX.
- Список паспортов, включенных в «черный список» - с накоплением сначала месяца. Формат – XLSX
  
В проекте необходимо продемонстрировать выгрузку данных с разных источник. Помимо плоских файлов, вам также предоставлена схема **BANK**, которая хранит дополнительные данные о клиентах

**Построение отчета.**

По результатам загрузки ежедневно необходимо строить витринуотчетности по мошенническим операциям. Витрина строитсянакоплением,каждый новый отчет укладывается в эту же таблицу с новым report_dt.

**Признаки мошеннических операций.**
- Совершение операции при просроченном или заблокированном паспорте.
- Совершение операции при недействующем договоре.
- Совершение операций в разных городах в течение одного часа.
- Попытка подбора суммы. В течение 20 минут проходит более 3х операций со следующим шаблоном – каждая последующая меньше предыдущей, при этом отклонены все кроме последней. Последняя операция (успешная) в такой цепочке считается мошеннической.


**Обработка файлов**
Выгружаемые файлы именуются согласно следующему шаблону:
- transactions_DDMMYYYY.txt
- passport_blacklist_DDMMYYYY.xlsx
- terminals_DDMMYYYY.xlsx
  
Предполагается что в один день приходит по одному такому файлу. Послезагрузки соответствующего файла он должен быть переименован в файл срасширением .backup чтобы при следующем запуске файл не искался иперемещен в каталог archive:
- transactions_DDMMYYYY.txt.backup
- passport_blacklist_DDMMYYYY.xlsx.backup
- terminals_DDMMYYYY.xlsx.backup
